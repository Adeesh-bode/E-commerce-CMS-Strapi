{"version":3,"file":"index-316a9e8a.mjs","sources":["../../admin/src/components/PluginIcon/index.js","../../admin/src/constants.js","../../admin/src/pluginId.js","../../admin/src/utils/getRelationType.js","../../admin/src/utils/makeUnique.js","../../admin/src/components/DataManagerProvider/constants.js","../../admin/src/components/DataManagerProvider/utils/retrieveComponentsFromSchema.js","../../admin/src/components/DataManagerProvider/reducer.js","../../admin/src/utils/nameToSlug.js","../../admin/src/components/FormModal/constants.js","../../admin/src/components/FormModal/utils/createUid.js","../../admin/src/components/FormModal/utils/customFieldDefaultOptionsReducer.js","../../admin/src/components/FormModal/utils/relations.js","../../admin/src/components/FormModal/reducer.js","../../admin/src/reducers.js","../../admin/src/utils/formAPI.js","../../admin/src/index.js"],"sourcesContent":["/**\n *\n * PluginIcon\n *\n */\n\nimport React from 'react';\n\nimport { Layout } from '@strapi/icons';\n\nconst PluginIcon = () => <Layout />;\n\nexport default PluginIcon;\n","export const PERMISSIONS = {\n  // This permission regards the main component (App) and is used to tell\n  // If the plugin link should be displayed in the menu\n  // And also if the plugin is accessible. This use case is found when a user types the url of the\n  // plugin directly in the browser\n  main: [{ action: 'plugin::content-type-builder.read', subject: null }],\n};\n","import pluginPkg from '../../package.json';\n\nconst pluginId = pluginPkg.name.replace(/^@strapi\\/plugin-/i, '');\n\nexport default pluginId;\n","/**\n *\n * Retrieves the relation type\n * @param {string} relation\n * @param {string} targetAttribute\n * @returns {string} the relation type\n */\nconst getRelationType = (relation, targetAttribute) => {\n  const hasNotTargetAttribute = targetAttribute === undefined || targetAttribute === null;\n\n  if (relation === 'oneToOne' && hasNotTargetAttribute) {\n    return 'oneWay';\n  }\n\n  if (relation === 'oneToMany' && hasNotTargetAttribute) {\n    return 'manyWay';\n  }\n\n  return relation;\n};\n\nexport default getRelationType;\n","const makeUnique = (array) => [...new Set(array)];\n\nexport default makeUnique;\n","export const ADD_ATTRIBUTE = 'ContentTypeBuilder/DataManagerProvider/ADD_ATTRIBUTE';\nexport const ADD_CUSTOM_FIELD_ATTRIBUTE =\n  'ContentTypeBuilder/DataManagerProvider/ADD_CUSTOM_FIELD_ATTRIBUTE';\nexport const ADD_CREATED_COMPONENT_TO_DYNAMIC_ZONE =\n  'ContentTypeBuilder/DataManagerProvider/ADD_CREATED_COMPONENT_TO_DYNAMIC_ZONE';\nexport const CHANGE_DYNAMIC_ZONE_COMPONENTS =\n  'ContentTypeBuilder/DataManagerProvider/CHANGE_DYNAMIC_ZONE_COMPONENTS';\nexport const CREATE_SCHEMA = 'ContentTypeBuilder/DataManagerProvider/CREATE_SCHEMA';\nexport const CREATE_COMPONENT_SCHEMA =\n  'ContentTypeBuilder/DataManagerProvider/CREATE_COMPONENT_SCHEMA';\nexport const DELETE_NOT_SAVED_TYPE = 'ContentTypeBuilder/DataManagerProvider/DELETE_NOT_SAVED_TYPE';\nexport const EDIT_ATTRIBUTE = 'ContentTypeBuilder/DataManagerProvider/EDIT_ATTRIBUTE';\nexport const EDIT_CUSTOM_FIELD_ATTRIBUTE =\n  'ContentTypeBuilder/DataManagerProvider/EDIT_CUSTOM_FIELD_ATTRIBUTE';\nexport const GET_DATA_SUCCEEDED = 'ContentTypeBuilder/DataManagerProvider/GET_DATA_SUCCEEDED';\nexport const RELOAD_PLUGIN = 'ContentTypeBuilder/DataManagerProvider/RELOAD_PLUGIN';\nexport const REMOVE_FIELD_FROM_DISPLAYED_COMPONENT =\n  'ContentTypeBuilder/DataManagerProvider/REMOVE_FIELD_FROM_DISPLAYED_COMPONENT';\nexport const REMOVE_COMPONENT_FROM_DYNAMIC_ZONE =\n  'ContentTypeBuilder/DataManagerProvider/REMOVE_COMPONENT_FROM_DYNAMIC_ZONE';\nexport const REMOVE_FIELD = 'ContentTypeBuilder/DataManagerProvider/REMOVE_FIELD';\nexport const SET_MODIFIED_DATA = 'ContentTypeBuilder/DataManagerProvider/SET_MODIFIED_DATA';\nexport const UPDATE_SCHEMA = 'ContentTypeBuilder/DataManagerProvider/UPDATE_SCHEMA';\n","import get from 'lodash/get';\n\nimport makeUnique from '../../../utils/makeUnique';\n\nconst retrieveComponentsFromSchema = (attributes, allComponentsData) => {\n  const allComponents = attributes.reduce((acc, current) => {\n    const type = current.type;\n\n    if (type === 'component') {\n      const currentComponentName = current.component;\n      // Push the existing compo\n      acc.push(currentComponentName);\n\n      const currentComponentAttributes = get(\n        allComponentsData,\n        [currentComponentName, 'schema', 'attributes'],\n        []\n      );\n\n      // Retrieve the nested ones\n      acc.push(...retrieveComponentsFromSchema(currentComponentAttributes, allComponentsData));\n    }\n\n    if (type === 'dynamiczone') {\n      const dynamicZoneComponents = current.components;\n      const componentsFromDZComponents = dynamicZoneComponents.reduce((acc2, currentUid) => {\n        const compoAttrs = get(allComponentsData, [currentUid, 'schema', 'attributes'], []);\n\n        return [...acc2, ...retrieveComponentsFromSchema(compoAttrs, allComponentsData)];\n      }, []);\n\n      return [...acc, ...dynamicZoneComponents, ...componentsFromDZComponents];\n    }\n\n    return acc;\n  }, []);\n\n  return makeUnique(allComponents);\n};\n\nexport default retrieveComponentsFromSchema;\n","import produce, { current } from 'immer';\nimport get from 'lodash/get';\nimport set from 'lodash/set';\n\nimport getRelationType from '../../utils/getRelationType';\nimport makeUnique from '../../utils/makeUnique';\n\nimport * as actions from './constants';\nimport retrieveComponentsFromSchema from './utils/retrieveComponentsFromSchema';\n\nconst initialState = {\n  components: {},\n  contentTypes: {},\n  initialComponents: {},\n  initialContentTypes: {},\n  initialData: {},\n  modifiedData: {},\n  reservedNames: {},\n  isLoading: true,\n  isLoadingForDataToBeSet: true,\n};\n\nconst ONE_SIDE_RELATIONS = ['oneWay', 'manyWay'];\n\nconst getOppositeRelation = (originalRelation) => {\n  if (originalRelation === 'manyToOne') {\n    return 'oneToMany';\n  }\n\n  if (originalRelation === 'oneToMany') {\n    return 'manyToOne';\n  }\n\n  return originalRelation;\n};\n\nconst findAttributeIndex = (schema, attributeToFind) => {\n  return schema.schema.attributes.findIndex(({ name }) => name === attributeToFind);\n};\n\nconst reducer = (state = initialState, action) =>\n  // eslint-disable-next-line consistent-return\n  produce(state, (draftState) => {\n    switch (action.type) {\n      case actions.ADD_ATTRIBUTE: {\n        const {\n          attributeToSet: { name, ...rest },\n          forTarget,\n          targetUid,\n        } = action;\n        delete rest.createComponent;\n\n        const pathToDataToEdit = ['component', 'contentType'].includes(forTarget)\n          ? [forTarget]\n          : [forTarget, targetUid];\n\n        const currentAttributes = get(\n          state,\n          ['modifiedData', ...pathToDataToEdit, 'schema', 'attributes'],\n          []\n        ).slice();\n\n        // Add the createdAttribute\n        const updatedAttributes = [...currentAttributes, { ...rest, name }];\n\n        set(\n          draftState,\n          ['modifiedData', ...pathToDataToEdit, 'schema', 'attributes'],\n          updatedAttributes\n        );\n\n        if (action.shouldAddComponentToData) {\n          const componentToAddUID = rest.component;\n          const componentToAdd = state.components[componentToAddUID];\n          const isTemporaryComponent = componentToAdd.isTemporary;\n          const hasComponentAlreadyBeenAdded =\n            state.modifiedData.components[componentToAddUID] !== undefined;\n\n          if (isTemporaryComponent || hasComponentAlreadyBeenAdded) {\n            break;\n          }\n\n          // Add the added component to the modifiedData.components\n          draftState.modifiedData.components[componentToAddUID] = componentToAdd;\n\n          const nestedComponents = retrieveComponentsFromSchema(\n            componentToAdd.schema.attributes,\n            state.components\n          );\n\n          // We dont' need to set the already added components otherwise all modifications will be lost so we need to only add the not modified ones\n          const nestedComponentsToAddInModifiedData = nestedComponents.filter((compoUID) => {\n            return get(state, ['modifiedData', 'components', compoUID]) === undefined;\n          });\n\n          nestedComponentsToAddInModifiedData.forEach((compoUID) => {\n            const compoSchema = get(state, ['components', compoUID], {});\n            const isTemporary = compoSchema.isTemporary || false;\n\n            // If the nested component has not been saved we don't need to add them as they are already in the state\n            if (!isTemporary) {\n              draftState.modifiedData.components[compoUID] = compoSchema;\n            }\n          });\n\n          break;\n        }\n\n        const isCreatingRelationAttribute = rest.type === 'relation';\n\n        if (isCreatingRelationAttribute) {\n          const target = rest.target;\n          const targetAttribute = rest.targetAttribute || null;\n          const relation = rest.relation;\n          const relationType = getRelationType(relation, targetAttribute);\n          const currentUid = get(state, ['modifiedData', ...pathToDataToEdit, 'uid']);\n\n          // When the user in creating a relation with the same content type we need to create another attribute\n          // that is the opposite of the created one\n          if (\n            rest.type === 'relation' &&\n            relationType !== 'oneWay' &&\n            relationType !== 'manyWay' &&\n            target === currentUid\n          ) {\n            const oppositeAttribute = {\n              name: targetAttribute,\n              relation: getOppositeRelation(relationType),\n              target,\n              targetAttribute: name,\n              type: 'relation',\n            };\n\n            if (rest.private) {\n              oppositeAttribute.private = rest.private;\n            }\n\n            const attributesToSet = [...updatedAttributes, oppositeAttribute];\n\n            set(\n              draftState,\n              ['modifiedData', ...pathToDataToEdit, 'schema', 'attributes'],\n              attributesToSet\n            );\n          }\n        }\n\n        break;\n      }\n      case actions.ADD_CREATED_COMPONENT_TO_DYNAMIC_ZONE: {\n        const { dynamicZoneTarget, componentsToAdd } = action;\n\n        const dzAttributeIndex = findAttributeIndex(\n          state.modifiedData.contentType,\n          dynamicZoneTarget\n        );\n\n        componentsToAdd.forEach((componentUid) => {\n          draftState.modifiedData.contentType.schema.attributes[dzAttributeIndex].components.push(\n            componentUid\n          );\n        });\n\n        break;\n      }\n      case actions.ADD_CUSTOM_FIELD_ATTRIBUTE: {\n        const {\n          attributeToSet: { name, ...rest },\n          forTarget,\n          targetUid,\n        } = action;\n\n        const pathToDataToEdit = ['component', 'contentType'].includes(forTarget)\n          ? [forTarget]\n          : [forTarget, targetUid];\n\n        const currentAttributes = get(\n          state,\n          ['modifiedData', ...pathToDataToEdit, 'schema', 'attributes'],\n          []\n        ).slice();\n\n        // Add the createdAttribute\n        const updatedAttributes = [...currentAttributes, { ...rest, name }];\n\n        set(\n          draftState,\n          ['modifiedData', ...pathToDataToEdit, 'schema', 'attributes'],\n          updatedAttributes\n        );\n\n        break;\n      }\n      case actions.CHANGE_DYNAMIC_ZONE_COMPONENTS: {\n        const { dynamicZoneTarget, newComponents } = action;\n\n        const dzAttributeIndex = findAttributeIndex(\n          state.modifiedData.contentType,\n          dynamicZoneTarget\n        );\n\n        const currentDZComponents =\n          state.modifiedData.contentType.schema.attributes[dzAttributeIndex].components;\n\n        const updatedComponents = makeUnique([...currentDZComponents, ...newComponents]);\n\n        draftState.modifiedData.contentType.schema.attributes[dzAttributeIndex].components =\n          updatedComponents;\n\n        // Retrieve all the components that needs to be added to the modifiedData.components\n        const nestedComponents = retrieveComponentsFromSchema(\n          current(draftState.modifiedData.contentType.schema.attributes),\n          state.components\n        );\n\n        // We dont' need to set the already added components otherwise all modifications will be lost so we need to only add the not modified ones\n        const nestedComponentsToAddInModifiedData = nestedComponents.filter((compoUID) => {\n          return get(state, ['modifiedData', 'components', compoUID]) === undefined;\n        });\n\n        nestedComponentsToAddInModifiedData.forEach((compoUID) => {\n          const compoSchema = get(state, ['components', compoUID], {});\n          const isTemporary = compoSchema.isTemporary || false;\n\n          // If the nested component has not been saved we don't need to add them as they are already in the state\n          if (!isTemporary) {\n            draftState.modifiedData.components[compoUID] = compoSchema;\n          }\n        });\n\n        break;\n      }\n      case actions.CREATE_COMPONENT_SCHEMA: {\n        const newSchema = {\n          uid: action.uid,\n          isTemporary: true,\n          category: action.componentCategory,\n          schema: {\n            ...action.data,\n            attributes: [],\n          },\n        };\n\n        draftState.components[action.uid] = newSchema;\n\n        if (action.shouldAddComponentToData) {\n          draftState.modifiedData.components[action.uid] = newSchema;\n        }\n\n        break;\n      }\n      case actions.CREATE_SCHEMA: {\n        const newSchema = {\n          uid: action.uid,\n          isTemporary: true,\n          schema: {\n            ...action.data,\n            attributes: [],\n          },\n        };\n\n        draftState.contentTypes[action.uid] = newSchema;\n\n        break;\n      }\n      case actions.EDIT_ATTRIBUTE: {\n        const {\n          attributeToSet: { name, ...rest },\n          forTarget,\n          targetUid,\n          initialAttribute,\n        } = action;\n\n        const initialAttributeName = initialAttribute.name;\n        const pathToDataToEdit = ['component', 'contentType'].includes(forTarget)\n          ? [forTarget]\n          : [forTarget, targetUid];\n\n        const initialAttributeIndex = findAttributeIndex(\n          get(state, ['modifiedData', ...pathToDataToEdit]),\n          initialAttributeName\n        );\n\n        const isEditingRelation = rest.type === 'relation';\n\n        if (!isEditingRelation) {\n          set(\n            draftState,\n            ['modifiedData', ...pathToDataToEdit, 'schema', 'attributes', initialAttributeIndex],\n            action.attributeToSet\n          );\n\n          break;\n        }\n\n        const updatedAttributes = get(state, [\n          'modifiedData',\n          ...pathToDataToEdit,\n          'schema',\n          'attributes',\n        ]).slice();\n\n        // First create the current relation attribute updated\n        const toSet = {\n          name,\n          relation: rest.relation,\n          target: rest.target,\n          targetAttribute: rest.targetAttribute,\n          type: 'relation',\n        };\n\n        if (rest.private) {\n          toSet.private = rest.private;\n        }\n\n        if (rest.pluginOptions) {\n          toSet.pluginOptions = rest.pluginOptions;\n        }\n\n        const currentAttributeIndex = updatedAttributes.findIndex(\n          ({ name }) => name === initialAttribute.name\n        );\n\n        // First set it in the updatedAttributes\n        if (currentAttributeIndex !== -1) {\n          updatedAttributes.splice(currentAttributeIndex, 1, toSet);\n        }\n\n        let oppositeAttributeNameToRemove = null;\n        let oppositeAttributeNameToUpdate = null;\n        let oppositeAttributeToCreate = null;\n        let initialOppositeAttribute = null;\n\n        const currentUid = get(state, ['modifiedData', ...pathToDataToEdit, 'uid']);\n        const didChangeTargetRelation = initialAttribute.target !== rest.target;\n        const didCreateInternalRelation = rest.target === currentUid;\n        const relationType = getRelationType(rest.relation, rest.targetAttribute);\n        const initialRelationType = getRelationType(\n          initialAttribute.relation,\n          initialAttribute.targetAttribute\n        );\n        const hadInternalRelation = initialAttribute.target === currentUid;\n        const didChangeRelationType = initialRelationType !== relationType;\n        const shouldRemoveOppositeAttributeBecauseOfTargetChange =\n          didChangeTargetRelation &&\n          !didCreateInternalRelation &&\n          hadInternalRelation &&\n          isEditingRelation;\n        const shouldRemoveOppositeAttributeBecauseOfRelationTypeChange =\n          didChangeRelationType &&\n          hadInternalRelation &&\n          ['oneWay', 'manyWay'].includes(relationType) &&\n          isEditingRelation;\n        const shouldUpdateOppositeAttributeBecauseOfRelationTypeChange =\n          !ONE_SIDE_RELATIONS.includes(initialRelationType) &&\n          !ONE_SIDE_RELATIONS.includes(relationType) &&\n          hadInternalRelation &&\n          didCreateInternalRelation &&\n          isEditingRelation;\n        const shouldCreateOppositeAttributeBecauseOfRelationTypeChange =\n          ONE_SIDE_RELATIONS.includes(initialRelationType) &&\n          !ONE_SIDE_RELATIONS.includes(relationType) &&\n          hadInternalRelation &&\n          didCreateInternalRelation &&\n          isEditingRelation;\n        const shouldCreateOppositeAttributeBecauseOfTargetChange =\n          didChangeTargetRelation &&\n          didCreateInternalRelation &&\n          !ONE_SIDE_RELATIONS.includes(relationType);\n\n        // Store opposite attribute name to remove at the end of the loop\n        if (\n          shouldRemoveOppositeAttributeBecauseOfTargetChange ||\n          shouldRemoveOppositeAttributeBecauseOfRelationTypeChange\n        ) {\n          oppositeAttributeNameToRemove = initialAttribute.targetAttribute;\n        }\n\n        // In case of oneWay or manyWay relation there isn't an opposite attribute\n        if (oppositeAttributeNameToRemove) {\n          const indexToRemove = updatedAttributes.findIndex(\n            ({ name }) => name === oppositeAttributeNameToRemove\n          );\n\n          updatedAttributes.splice(indexToRemove, 1);\n        }\n\n        // In order to preserve plugin options need to get the initial opposite attribute settings\n        if (!shouldRemoveOppositeAttributeBecauseOfTargetChange) {\n          const initialTargetContentType = get(state, [\n            'initialContentTypes',\n            initialAttribute.target,\n          ]);\n\n          if (initialTargetContentType) {\n            const oppositeAttributeIndex = findAttributeIndex(\n              initialTargetContentType,\n              initialAttribute.targetAttribute\n            );\n\n            initialOppositeAttribute = get(state, [\n              'initialContentTypes',\n              initialAttribute.target,\n              'schema',\n              'attributes',\n              oppositeAttributeIndex,\n            ]);\n          }\n        }\n\n        // Create the opposite attribute\n        if (\n          shouldCreateOppositeAttributeBecauseOfRelationTypeChange ||\n          shouldCreateOppositeAttributeBecauseOfTargetChange\n        ) {\n          oppositeAttributeToCreate = {\n            name: rest.targetAttribute,\n            relation: getOppositeRelation(relationType),\n            target: rest.target,\n            targetAttribute: name,\n            type: 'relation',\n          };\n\n          if (rest.private) {\n            oppositeAttributeToCreate.private = rest.private;\n          }\n\n          if (initialOppositeAttribute && initialOppositeAttribute.pluginOptions) {\n            oppositeAttributeToCreate.pluginOptions = initialOppositeAttribute.pluginOptions;\n          }\n\n          const indexOfInitialAttribute = updatedAttributes.findIndex(\n            ({ name }) => name === initialAttribute.name\n          );\n          const indexOfUpdatedAttribute = updatedAttributes.findIndex(\n            ({ name: attrName }) => name === attrName\n          );\n\n          const indexToInsert =\n            (indexOfInitialAttribute === -1 ? indexOfUpdatedAttribute : indexOfInitialAttribute) +\n            1;\n\n          updatedAttributes.splice(indexToInsert, 0, oppositeAttributeToCreate);\n        }\n\n        if (shouldUpdateOppositeAttributeBecauseOfRelationTypeChange) {\n          oppositeAttributeNameToUpdate = initialAttribute.targetAttribute;\n\n          oppositeAttributeToCreate = {\n            name: rest.targetAttribute,\n            relation: getOppositeRelation(relationType),\n            target: rest.target,\n            targetAttribute: name,\n            type: 'relation',\n          };\n\n          if (rest.private) {\n            oppositeAttributeToCreate.private = rest.private;\n          }\n\n          if (initialOppositeAttribute && initialOppositeAttribute.pluginOptions) {\n            oppositeAttributeToCreate.pluginOptions = initialOppositeAttribute.pluginOptions;\n          }\n\n          if (oppositeAttributeNameToUpdate) {\n            const indexToUpdate = updatedAttributes.findIndex(\n              ({ name }) => name === oppositeAttributeNameToUpdate\n            );\n\n            updatedAttributes.splice(indexToUpdate, 1, oppositeAttributeToCreate);\n          }\n        }\n\n        set(\n          draftState,\n          ['modifiedData', ...pathToDataToEdit, 'schema', 'attributes'],\n          updatedAttributes\n        );\n\n        break;\n      }\n      case actions.EDIT_CUSTOM_FIELD_ATTRIBUTE: {\n        const { forTarget, targetUid, initialAttribute, attributeToSet } = action;\n\n        const initialAttributeName = initialAttribute.name;\n        const pathToDataToEdit = ['component', 'contentType'].includes(forTarget)\n          ? [forTarget]\n          : [forTarget, targetUid];\n\n        const initialAttributeIndex = findAttributeIndex(\n          get(state, ['modifiedData', ...pathToDataToEdit]),\n          initialAttributeName\n        );\n\n        set(\n          draftState,\n          ['modifiedData', ...pathToDataToEdit, 'schema', 'attributes', initialAttributeIndex],\n          attributeToSet\n        );\n\n        break;\n      }\n      case actions.GET_DATA_SUCCEEDED: {\n        draftState.components = action.components;\n        draftState.initialComponents = action.components;\n        draftState.initialContentTypes = action.contentTypes;\n        draftState.contentTypes = action.contentTypes;\n        draftState.reservedNames = action.reservedNames;\n        draftState.isLoading = false;\n\n        break;\n      }\n      case actions.DELETE_NOT_SAVED_TYPE: {\n        // Doing so will also reset the modified and the initial data\n        draftState.contentTypes = state.initialContentTypes;\n        draftState.components = state.initialComponents;\n\n        break;\n      }\n      case actions.RELOAD_PLUGIN: {\n        return initialState;\n      }\n      case actions.REMOVE_COMPONENT_FROM_DYNAMIC_ZONE: {\n        const dzAttributeIndex = findAttributeIndex(state.modifiedData.contentType, action.dzName);\n\n        draftState.modifiedData.contentType.schema.attributes[dzAttributeIndex].components.splice(\n          action.componentToRemoveIndex,\n          1\n        );\n\n        break;\n      }\n      case actions.REMOVE_FIELD: {\n        const { mainDataKey, attributeToRemoveName } = action;\n        const pathToAttributes = ['modifiedData', mainDataKey, 'schema', 'attributes'];\n        const attributeToRemoveIndex = findAttributeIndex(\n          state.modifiedData[mainDataKey],\n          attributeToRemoveName\n        );\n\n        const pathToAttributeToRemove = [...pathToAttributes, attributeToRemoveIndex];\n        const attributeToRemoveData = get(state, pathToAttributeToRemove);\n        const isRemovingRelationAttribute = attributeToRemoveData.type === 'relation';\n        // Only content types can have relations with themselves since\n        // components can only have oneWay or manyWay relations\n        const canTheAttributeToRemoveHaveARelationWithItself = mainDataKey === 'contentType';\n\n        if (isRemovingRelationAttribute && canTheAttributeToRemoveHaveARelationWithItself) {\n          const { target, relation, targetAttribute } = attributeToRemoveData;\n          const relationType = getRelationType(relation, targetAttribute);\n\n          const uid = state.modifiedData.contentType.uid;\n          const shouldRemoveOppositeAttribute =\n            target === uid && !ONE_SIDE_RELATIONS.includes(relationType);\n\n          if (shouldRemoveOppositeAttribute) {\n            const attributes = state.modifiedData[mainDataKey].schema.attributes.slice();\n            const nextAttributes = attributes.filter((attribute) => {\n              if (attribute.name === attributeToRemoveName) {\n                return false;\n              }\n\n              if (attribute.target === uid && attribute.targetAttribute === attributeToRemoveName) {\n                return false;\n              }\n\n              return true;\n            });\n\n            draftState.modifiedData[mainDataKey].schema.attributes = nextAttributes;\n\n            break;\n          }\n        }\n\n        // Find all uid fields that have the targetField set to the field we are removing\n        const uidFieldsToUpdate = state.modifiedData[mainDataKey].schema.attributes\n          .slice()\n          .reduce((acc, current) => {\n            if (current.type !== 'uid') {\n              return acc;\n            }\n\n            if (current.targetField !== attributeToRemoveName) {\n              return acc;\n            }\n\n            acc.push(current.name);\n\n            return acc;\n          }, []);\n\n        uidFieldsToUpdate.forEach((fieldName) => {\n          const fieldIndex = findAttributeIndex(state.modifiedData[mainDataKey], fieldName);\n\n          delete draftState.modifiedData[mainDataKey].schema.attributes[fieldIndex].targetField;\n        });\n\n        draftState.modifiedData[mainDataKey].schema.attributes.splice(attributeToRemoveIndex, 1);\n\n        break;\n      }\n      case actions.REMOVE_FIELD_FROM_DISPLAYED_COMPONENT: {\n        const { attributeToRemoveName, componentUid } = action;\n\n        const attributeToRemoveIndex = findAttributeIndex(\n          state.modifiedData.components[componentUid],\n          attributeToRemoveName\n        );\n\n        draftState.modifiedData.components[componentUid].schema.attributes.splice(\n          attributeToRemoveIndex,\n          1\n        );\n\n        break;\n      }\n      case actions.SET_MODIFIED_DATA: {\n        draftState.isLoadingForDataToBeSet = false;\n        draftState.initialData = action.schemaToSet;\n        draftState.modifiedData = action.schemaToSet;\n\n        // Reset the state with the initial data\n        // All created components and content types will be lost\n        if (!action.hasJustCreatedSchema) {\n          draftState.components = state.initialComponents;\n          draftState.contentTypes = state.initialContentTypes;\n        }\n\n        break;\n      }\n      case actions.UPDATE_SCHEMA: {\n        const {\n          data: { displayName, category, icon, kind },\n          schemaType,\n          uid,\n        } = action;\n\n        draftState.modifiedData[schemaType].schema.displayName = displayName;\n\n        if (action.schemaType === 'component') {\n          draftState.modifiedData.component.category = category;\n          draftState.modifiedData.component.schema.icon = icon;\n          const addedComponent = current(draftState.modifiedData.component);\n          draftState.components[uid] = addedComponent;\n\n          break;\n        }\n\n        draftState.modifiedData.contentType.schema.kind = kind;\n\n        break;\n      }\n      default:\n        return draftState;\n    }\n  });\n\nexport default reducer;\nexport { initialState };\n","import slugify from '@sindresorhus/slugify';\n\nconst nameToSlug = (name) => slugify(name, { separator: '-' });\n\nexport default nameToSlug;\n","export const ON_CHANGE = 'ContentTypeBuilder/FormModal/ON_CHANGE';\nexport const ON_CHANGE_RELATION_TARGET = 'ContentTypeBuilder/FormModal/ON_CHANGE_RELATION_TARGET';\nexport const ON_CHANGE_RELATION_TYPE = 'ContentTypeBuilder/FormModal/ON_CHANGE_RELATION_TYPE';\nexport const RESET_PROPS = 'ContentTypeBuilder/FormModal/RESET_PROPS';\nexport const RESET_PROPS_AND_SET_FORM_FOR_ADDING_AN_EXISTING_COMPO =\n  'ContentTypeBuilder/FormModal/RESET_PROPS_AND_SET_FORM_FOR_ADDING_AN_EXISTING_COMPO';\nexport const RESET_PROPS_AND_SAVE_CURRENT_DATA =\n  'ContentTypeBuilder/FormModal/RESET_PROPS_AND_SAVE_CURRENT_DATA';\nexport const RESET_PROPS_AND_SET_THE_FORM_FOR_ADDING_A_COMPO_TO_A_DZ =\n  'ContentTypeBuilder/FormModal/RESET_PROPS_AND_SET_THE_FORM_FOR_ADDING_A_COMPO_TO_A_DZ';\nexport const SET_DATA_TO_EDIT = 'ContentTypeBuilder/FormModal/SET_DATA_TO_EDIT';\nexport const SET_ATTRIBUTE_DATA_SCHEMA = 'ContentTypeBuilder/FormModal/SET_ATTRIBUTE_DATA_SCHEMA';\nexport const SET_CUSTOM_FIELD_DATA_SCHEMA =\n  'ContentTypeBuilder/FormModal/SET_CUSTOM_FIELD_DATA_SCHEMA';\nexport const SET_DYNAMIC_ZONE_DATA_SCHEMA =\n  'ContentTypeBuilder/FormModal/SET_DYNAMIC_ZONE_DATA_SCHEMA';\nexport const SET_ERRORS = 'ContentTypeBuilder/FormModal/SET_ERRORS';\n","import nameToSlug from '../../../utils/nameToSlug';\n\nconst createUid = (name) => {\n  const modelName = nameToSlug(name);\n  const uid = `api::${modelName}.${modelName}`;\n\n  return uid;\n};\n\n// From `content-type-builder/services/Components/createComponentUid`\nconst createComponentUid = (name, category) => {\n  return `${nameToSlug(category)}.${nameToSlug(name)}`;\n};\n\nexport { createComponentUid, createUid };\n","const customFieldDefaultOptionsReducer = (acc, option) => {\n  if (option.items) {\n    return option.items.reduce(customFieldDefaultOptionsReducer, acc);\n  }\n\n  if ('defaultValue' in option) {\n    const { name, defaultValue } = option;\n    acc.push({ name, defaultValue });\n  }\n\n  return acc;\n};\n\nexport { customFieldDefaultOptionsReducer };\n","/* eslint-disable no-confusing-arrow */\n\nconst shouldPluralizeName = (nature) =>\n  ['manyToMany', 'oneToMany', 'manyWay'].includes(nature) ? 2 : 1;\n\nconst shouldPluralizeTargetAttribute = (nature) =>\n  ['manyToMany', 'manyToOne'].includes(nature) ? 2 : 1;\n\nexport { shouldPluralizeName, shouldPluralizeTargetAttribute };\n","import produce from 'immer';\nimport set from 'lodash/set';\nimport snakeCase from 'lodash/snakeCase';\nimport pluralize from 'pluralize';\n\nimport getRelationType from '../../utils/getRelationType';\nimport nameToSlug from '../../utils/nameToSlug';\n\nimport * as actions from './constants';\nimport { createComponentUid } from './utils/createUid';\nimport { customFieldDefaultOptionsReducer } from './utils/customFieldDefaultOptionsReducer';\nimport { shouldPluralizeName, shouldPluralizeTargetAttribute } from './utils/relations';\n\nconst initialState = {\n  formErrors: {},\n  modifiedData: {},\n  initialData: {},\n  componentToCreate: {},\n  isCreatingComponentWhileAddingAField: false,\n};\n\nconst reducer = (state = initialState, action) =>\n  // eslint-disable-next-line consistent-return\n  produce(state, (draftState) => {\n    switch (action.type) {\n      case actions.ON_CHANGE: {\n        const { keys, value } = action;\n        const obj = state.modifiedData;\n        const hasDefaultValue = Boolean(obj.default);\n\n        // There is no need to remove the default key if the default value isn't defined\n        if (hasDefaultValue && keys.length === 1 && keys.includes('type')) {\n          const previousType = obj.type;\n\n          if (previousType && ['date', 'datetime', 'time'].includes(previousType)) {\n            // return obj.updateIn(keys, () => value).remove('default');\n            delete draftState.modifiedData.default;\n          }\n        }\n\n        set(draftState, ['modifiedData', ...keys], value);\n\n        break;\n      }\n      case actions.ON_CHANGE_RELATION_TARGET: {\n        const {\n          target: {\n            oneThatIsCreatingARelationWithAnother,\n            selectedContentTypeFriendlyName,\n            targetContentTypeAllowedRelations,\n            value,\n          },\n        } = action;\n        // Special case for the admin user...\n        let didChangeRelationTypeBecauseOfRestrictedRelation = false;\n        let changedRelationType = null;\n\n        set(draftState, ['modifiedData', 'target'], value);\n\n        const modifiedData = state.modifiedData;\n\n        // Don't change the relation type if the allowed relations are not restricted\n        // TODO: replace with an obj { relation: 'x', bidirctional: true|false } when BE ready\n        if (Array.isArray(targetContentTypeAllowedRelations)) {\n          const currentRelationType = getRelationType(\n            modifiedData.relation,\n            modifiedData.targetAttribute\n          );\n\n          if (!targetContentTypeAllowedRelations.includes(currentRelationType)) {\n            const relationToSet = targetContentTypeAllowedRelations[0];\n            didChangeRelationTypeBecauseOfRestrictedRelation = true;\n            changedRelationType = relationToSet;\n\n            if (relationToSet === 'oneWay') {\n              set(draftState, ['modifiedData', 'relation'], 'oneToOne');\n            } else if (relationToSet === 'manyWay') {\n              set(draftState, ['modifiedData', 'relation'], 'oneToMany');\n            } else {\n              set(draftState, ['modifiedData', 'relation'], relationToSet);\n            }\n          }\n        }\n\n        let nameToSet;\n\n        if (didChangeRelationTypeBecauseOfRestrictedRelation) {\n          nameToSet = pluralize(\n            snakeCase(nameToSlug(selectedContentTypeFriendlyName)),\n            shouldPluralizeName(changedRelationType)\n          );\n        } else {\n          nameToSet = pluralize(\n            snakeCase(nameToSlug(selectedContentTypeFriendlyName)),\n\n            shouldPluralizeName(modifiedData.relation)\n          );\n        }\n\n        set(draftState, ['modifiedData', 'name'], nameToSet);\n\n        const currentTargetAttribute = state.modifiedData.targetAttribute;\n\n        if (currentTargetAttribute === null) {\n          break;\n        }\n\n        // Changing the target and the relation is either oneWay or manyWay\n        // Case when we need to change the relation to oneWay (ex: admin user)\n        if (\n          didChangeRelationTypeBecauseOfRestrictedRelation &&\n          ['oneWay', 'manyWay'].includes(changedRelationType)\n        ) {\n          set(draftState, ['modifiedData', 'targetAttribute'], null);\n\n          break;\n        }\n\n        const targetAttributeToSet = pluralize(\n          snakeCase(nameToSlug(oneThatIsCreatingARelationWithAnother)),\n          shouldPluralizeTargetAttribute(modifiedData.relation)\n        );\n\n        set(draftState, ['modifiedData', 'targetAttribute'], targetAttributeToSet);\n\n        break;\n      }\n      case actions.ON_CHANGE_RELATION_TYPE: {\n        const {\n          target: { oneThatIsCreatingARelationWithAnother, value },\n        } = action;\n\n        const currentName = state.modifiedData.name;\n\n        // Switching from oneWay\n        if (!['oneWay', 'manyWay'].includes(value)) {\n          set(draftState, ['modifiedData', 'relation'], value);\n          const currentTargetAttribute = state.modifiedData.targetAttribute;\n\n          set(\n            draftState,\n            ['modifiedData', 'name'],\n            pluralize(snakeCase(nameToSlug(currentName)), shouldPluralizeName(value))\n          );\n\n          set(\n            draftState,\n            ['modifiedData', 'targetAttribute'],\n            pluralize(\n              currentTargetAttribute ||\n                snakeCase(nameToSlug(oneThatIsCreatingARelationWithAnother)),\n              shouldPluralizeTargetAttribute(value)\n            )\n          );\n\n          break;\n        }\n\n        if (value === 'oneWay') {\n          set(draftState, ['modifiedData', 'relation'], 'oneToOne');\n          set(draftState, ['modifiedData', 'targetAttribute'], null);\n          set(draftState, ['modifiedData', 'name'], pluralize(snakeCase(currentName), 1));\n\n          break;\n        }\n\n        // manyWay\n        set(draftState, ['modifiedData', 'relation'], 'oneToMany');\n        set(draftState, ['modifiedData', 'targetAttribute'], null);\n        set(draftState, ['modifiedData', 'name'], pluralize(snakeCase(currentName), 2));\n\n        break;\n      }\n\n      case actions.RESET_PROPS:\n        return initialState;\n      case actions.RESET_PROPS_AND_SET_FORM_FOR_ADDING_AN_EXISTING_COMPO: {\n        // This is run when the user doesn't want to create a new component\n\n        const nextState = {\n          ...initialState,\n          modifiedData: {\n            type: 'component',\n            repeatable: true,\n            ...action.options,\n          },\n        };\n\n        return nextState;\n      }\n      case actions.RESET_PROPS_AND_SAVE_CURRENT_DATA: {\n        // This is run when the user has created a new component\n        const componentToCreate = state.modifiedData.componentToCreate;\n        const modifiedData = {\n          displayName: componentToCreate.displayName,\n          type: 'component',\n          repeatable: false,\n          ...action.options,\n          component: createComponentUid(componentToCreate.displayName, componentToCreate.category),\n        };\n\n        const nextState = {\n          ...initialState,\n          componentToCreate,\n          modifiedData,\n          isCreatingComponentWhileAddingAField: state.modifiedData.createComponent,\n        };\n\n        return nextState;\n      }\n      case actions.RESET_PROPS_AND_SET_THE_FORM_FOR_ADDING_A_COMPO_TO_A_DZ: {\n        const createdDZ = state.modifiedData;\n        const dataToSet = {\n          ...createdDZ,\n          createComponent: true,\n          componentToCreate: { type: 'component' },\n        };\n\n        return { ...initialState, modifiedData: dataToSet };\n      }\n      case actions.SET_DATA_TO_EDIT: {\n        draftState.modifiedData = action.data;\n        draftState.initialData = action.data;\n        break;\n      }\n      case actions.SET_ATTRIBUTE_DATA_SCHEMA: {\n        const {\n          attributeType,\n          isEditing,\n          modifiedDataToSetForEditing,\n          nameToSetForRelation,\n          targetUid,\n          step,\n          options = {},\n        } = action;\n\n        if (isEditing) {\n          draftState.modifiedData = modifiedDataToSetForEditing;\n          draftState.initialData = modifiedDataToSetForEditing;\n\n          break;\n        }\n\n        let dataToSet;\n\n        if (attributeType === 'component') {\n          if (step === '1') {\n            dataToSet = {\n              type: 'component',\n              createComponent: true,\n              componentToCreate: { type: 'component' },\n            };\n          } else {\n            dataToSet = {\n              ...options,\n              type: 'component',\n              repeatable: true,\n            };\n          }\n        } else if (attributeType === 'dynamiczone') {\n          dataToSet = {\n            ...options,\n            type: 'dynamiczone',\n            components: [],\n          };\n        } else if (attributeType === 'text') {\n          dataToSet = { ...options, type: 'string' };\n        } else if (attributeType === 'number' || attributeType === 'date') {\n          dataToSet = options;\n        } else if (attributeType === 'media') {\n          dataToSet = {\n            allowedTypes: ['images', 'files', 'videos', 'audios'],\n            type: 'media',\n            multiple: true,\n            ...options,\n          };\n        } else if (attributeType === 'enumeration') {\n          dataToSet = { ...options, type: 'enumeration', enum: [] };\n        } else if (attributeType === 'relation') {\n          dataToSet = {\n            name: snakeCase(nameToSetForRelation),\n            relation: 'oneToOne',\n            targetAttribute: null,\n            target: targetUid,\n            type: 'relation',\n          };\n        } else {\n          dataToSet = { ...options, type: attributeType, default: null };\n        }\n\n        draftState.modifiedData = dataToSet;\n\n        break;\n      }\n      case actions.SET_CUSTOM_FIELD_DATA_SCHEMA: {\n        const { customField, isEditing, modifiedDataToSetForEditing, options = {} } = action;\n\n        if (isEditing) {\n          draftState.modifiedData = modifiedDataToSetForEditing;\n          draftState.initialData = modifiedDataToSetForEditing;\n\n          break;\n        }\n\n        draftState.modifiedData = { ...options, type: customField.type };\n\n        const allOptions = [\n          ...(customField?.options?.base || []),\n          ...(customField?.options?.advanced || []),\n        ];\n\n        const optionDefaults = allOptions.reduce(customFieldDefaultOptionsReducer, []);\n\n        if (optionDefaults.length) {\n          optionDefaults.forEach(({ name, defaultValue }) =>\n            set(draftState.modifiedData, name, defaultValue)\n          );\n        }\n\n        break;\n      }\n      case actions.SET_DYNAMIC_ZONE_DATA_SCHEMA: {\n        draftState.modifiedData = action.attributeToEdit;\n        draftState.initialData = action.attributeToEdit;\n        break;\n      }\n      case actions.SET_ERRORS: {\n        draftState.formErrors = action.errors;\n        break;\n      }\n      default:\n        return draftState;\n    }\n  });\n\nexport default reducer;\nexport { initialState };\n","import dataManagerProvider from './components/DataManagerProvider/reducer';\nimport formModalReducer from './components/FormModal/reducer';\nimport pluginId from './pluginId';\n\nconst reducers = {\n  [`${pluginId}_formModal`]: formModalReducer,\n  [`${pluginId}_dataManagerProvider`]: dataManagerProvider,\n};\n\nexport default reducers;\n","import cloneDeep from 'lodash/cloneDeep';\nimport get from 'lodash/get';\nimport * as yup from 'yup';\n\nconst formsAPI = {\n  components: {\n    inputs: {},\n    add({ id, component }) {\n      if (!this.inputs[id]) {\n        this.inputs[id] = component;\n      }\n    },\n  },\n  types: {\n    attribute: {\n      // test: {\n      //   validators: [],\n      //   form: {\n      //     advanced: [\n      //       /* cb */\n      //     ],\n      //     base: [\n      //       /* cb */\n      //     ],\n      //   },\n      // },\n    },\n    contentType: {\n      validators: [],\n      form: {\n        advanced: [],\n        base: [],\n      },\n    },\n    component: {\n      validators: [],\n      form: {\n        advanced: [],\n        base: [],\n      },\n    },\n  },\n  contentTypeSchemaMutations: [],\n  addContentTypeSchemaMutation(cb) {\n    this.contentTypeSchemaMutations.push(cb);\n  },\n  extendContentType({ validator, form: { advanced, base } }) {\n    const { contentType } = this.types;\n\n    contentType.validators.push(validator);\n    contentType.form.advanced.push(advanced);\n    contentType.form.base.push(base);\n  },\n  extendFields(fields, { validator, form: { advanced, base } }) {\n    const formType = this.types.attribute;\n\n    fields.forEach((field) => {\n      if (!formType[field]) {\n        formType[field] = {\n          validators: [],\n          form: {\n            advanced: [\n              /* cb */\n            ],\n            base: [\n              /* cb */\n            ],\n          },\n        };\n      }\n\n      formType[field].validators.push(validator);\n      formType[field].form.advanced.push(advanced);\n      formType[field].form.base.push(base);\n    });\n  },\n\n  getAdvancedForm(target, props = null) {\n    const sectionsToAdd = get(this.types, [...target, 'form', 'advanced'], []).reduce(\n      (acc, current) => {\n        const sections = current(props);\n\n        return [...acc, ...sections];\n      },\n      []\n    );\n\n    return sectionsToAdd;\n  },\n\n  makeCustomFieldValidator(attributeShape, validator, ...validatorArgs) {\n    // When no validator, return the attribute shape\n    if (!validator) return attributeShape;\n\n    // Otherwise extend the shape with the provided validator\n    return attributeShape.shape({ options: yup.object().shape(validator(validatorArgs)) });\n  },\n\n  makeValidator(target, initShape, ...args) {\n    const validators = get(this.types, [...target, 'validators'], []);\n\n    const pluginOptionsShape = validators.reduce((acc, current) => {\n      const pluginOptionShape = current(args);\n\n      return { ...acc, ...pluginOptionShape };\n    }, {});\n\n    return initShape.shape({ pluginOptions: yup.object().shape(pluginOptionsShape) });\n  },\n  mutateContentTypeSchema(data, initialData) {\n    let enhancedData = cloneDeep(data);\n\n    const refData = cloneDeep(initialData);\n\n    this.contentTypeSchemaMutations.forEach((cb) => {\n      enhancedData = cb(enhancedData, refData);\n    });\n\n    return enhancedData;\n  },\n};\n\nexport default formsAPI;\n","import { prefixPluginTranslations } from '@strapi/helper-plugin';\n\nimport pluginPkg from '../../package.json';\n\nimport PluginIcon from './components/PluginIcon';\nimport { PERMISSIONS } from './constants';\nimport pluginId from './pluginId';\nimport reducers from './reducers';\nimport formsAPI from './utils/formAPI';\n\nconst name = pluginPkg.strapi.name;\n\nexport default {\n  register(app) {\n    app.addReducers(reducers);\n\n    app.addMenuLink({\n      to: `/plugins/${pluginId}`,\n      icon: PluginIcon,\n      intlLabel: {\n        id: `${pluginId}.plugin.name`,\n        defaultMessage: 'Content Types Builder',\n      },\n      permissions: PERMISSIONS.main,\n      async Component() {\n        const component = await import('./pages/App');\n\n        return component;\n      },\n    });\n\n    app.registerPlugin({\n      id: pluginId,\n      name,\n      // Internal APIs exposed by the CTB for the other plugins to use\n      apis: {\n        forms: formsAPI,\n      },\n    });\n  },\n  bootstrap() {},\n  async registerTrads({ locales }) {\n    const importedTrads = await Promise.all(\n      locales.map((locale) => {\n        return import(`./translations/${locale}.json`)\n          .then(({ default: data }) => {\n            return {\n              data: prefixPluginTranslations(data, pluginId),\n              locale,\n            };\n          })\n          .catch(() => {\n            return {\n              data: {},\n              locale,\n            };\n          });\n      })\n    );\n\n    return Promise.resolve(importedTrads);\n  },\n};\n"],"names":["current","initialState","name","reducer","actions.ADD_ATTRIBUTE","actions.ADD_CREATED_COMPONENT_TO_DYNAMIC_ZONE","actions.ADD_CUSTOM_FIELD_ATTRIBUTE","actions.CHANGE_DYNAMIC_ZONE_COMPONENTS","actions.CREATE_COMPONENT_SCHEMA","actions.CREATE_SCHEMA","actions.EDIT_ATTRIBUTE","actions.EDIT_CUSTOM_FIELD_ATTRIBUTE","actions.GET_DATA_SUCCEEDED","actions.DELETE_NOT_SAVED_TYPE","actions.RELOAD_PLUGIN","actions.REMOVE_COMPONENT_FROM_DYNAMIC_ZONE","actions.REMOVE_FIELD","actions.REMOVE_FIELD_FROM_DISPLAYED_COMPONENT","actions.SET_MODIFIED_DATA","actions.UPDATE_SCHEMA","actions.ON_CHANGE","actions.ON_CHANGE_RELATION_TARGET","actions.ON_CHANGE_RELATION_TYPE","actions.RESET_PROPS","actions.RESET_PROPS_AND_SET_FORM_FOR_ADDING_AN_EXISTING_COMPO","actions.RESET_PROPS_AND_SAVE_CURRENT_DATA","actions.RESET_PROPS_AND_SET_THE_FORM_FOR_ADDING_A_COMPO_TO_A_DZ","actions.SET_DATA_TO_EDIT","actions.SET_ATTRIBUTE_DATA_SCHEMA","actions.SET_CUSTOM_FIELD_DATA_SCHEMA","actions.SET_DYNAMIC_ZONE_DATA_SCHEMA","actions.SET_ERRORS","formModalReducer","dataManagerProvider"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUA,MAAM,aAAa,MAAM,oBAAC,QAAO,EAAA;ACV1B,MAAM,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA,EAKzB,MAAM,CAAC,EAAE,QAAQ,qCAAqC,SAAS,MAAM;AACvE;ACJA,MAAM,WAAW,UAAU,KAAK,QAAQ,sBAAsB,EAAE;ACK1D,MAAA,kBAAkB,CAAC,UAAU,oBAAoB;AAC/C,QAAA,wBAAwB,oBAAoB,UAAa,oBAAoB;AAE/E,MAAA,aAAa,cAAc,uBAAuB;AAC7C,WAAA;AAAA,EACT;AAEI,MAAA,aAAa,eAAe,uBAAuB;AAC9C,WAAA;AAAA,EACT;AAEO,SAAA;AACT;ACnBM,MAAA,aAAa,CAAC,UAAU,CAAC,GAAG,IAAI,IAAI,KAAK,CAAC;ACAzC,MAAM,gBAAgB;AACtB,MAAM,6BACX;AACK,MAAM,wCACX;AACK,MAAM,iCACX;AACK,MAAM,gBAAgB;AACtB,MAAM,0BACX;AACK,MAAM,wBAAwB;AAC9B,MAAM,iBAAiB;AACvB,MAAM,8BACX;AACK,MAAM,qBAAqB;AAC3B,MAAM,gBAAgB;AACtB,MAAM,wCACX;AACK,MAAM,qCACX;AACK,MAAM,eAAe;AACrB,MAAM,oBAAoB;AAC1B,MAAM,gBAAgB;AClBvB,MAAA,+BAA+B,CAAC,YAAY,sBAAsB;AACtE,QAAM,gBAAgB,WAAW,OAAO,CAAC,KAAKA,aAAY;AACxD,UAAM,OAAOA,SAAQ;AAErB,QAAI,SAAS,aAAa;AACxB,YAAM,uBAAuBA,SAAQ;AAErC,UAAI,KAAK,oBAAoB;AAE7B,YAAM,6BAA6B;AAAA,QACjC;AAAA,QACA,CAAC,sBAAsB,UAAU,YAAY;AAAA,QAC7C,CAAC;AAAA,MAAA;AAIH,UAAI,KAAK,GAAG,6BAA6B,4BAA4B,iBAAiB,CAAC;AAAA,IACzF;AAEA,QAAI,SAAS,eAAe;AAC1B,YAAM,wBAAwBA,SAAQ;AACtC,YAAM,6BAA6B,sBAAsB,OAAO,CAAC,MAAM,eAAe;AAC9E,cAAA,aAAa,IAAI,mBAAmB,CAAC,YAAY,UAAU,YAAY,GAAG,CAAA,CAAE;AAElF,eAAO,CAAC,GAAG,MAAM,GAAG,6BAA6B,YAAY,iBAAiB,CAAC;AAAA,MACjF,GAAG,CAAE,CAAA;AAEL,aAAO,CAAC,GAAG,KAAK,GAAG,uBAAuB,GAAG,0BAA0B;AAAA,IACzE;AAEO,WAAA;AAAA,EACT,GAAG,CAAE,CAAA;AAEL,SAAO,WAAW,aAAa;AACjC;AC5BA,MAAMC,iBAAe;AAAA,EACnB,YAAY,CAAC;AAAA,EACb,cAAc,CAAC;AAAA,EACf,mBAAmB,CAAC;AAAA,EACpB,qBAAqB,CAAC;AAAA,EACtB,aAAa,CAAC;AAAA,EACd,cAAc,CAAC;AAAA,EACf,eAAe,CAAC;AAAA,EAChB,WAAW;AAAA,EACX,yBAAyB;AAC3B;AAEA,MAAM,qBAAqB,CAAC,UAAU,SAAS;AAE/C,MAAM,sBAAsB,CAAC,qBAAqB;AAChD,MAAI,qBAAqB,aAAa;AAC7B,WAAA;AAAA,EACT;AAEA,MAAI,qBAAqB,aAAa;AAC7B,WAAA;AAAA,EACT;AAEO,SAAA;AACT;AAEA,MAAM,qBAAqB,CAAC,QAAQ,oBAAoB;AAC/C,SAAA,OAAO,OAAO,WAAW,UAAU,CAAC,EAAE,MAAAC,MAAW,MAAAA,UAAS,eAAe;AAClF;AAEA,MAAMC,YAAU,CAAC,QAAQF,gBAAc;AAAA;AAAA,EAErC,QAAQ,OAAO,CAAC,eAAe;AAC7B,YAAQ,OAAO,MAAM;AAAA,MACnB,KAAKG,eAAuB;AACpB,cAAA;AAAA,UACJ,gBAAgB,EAAE,MAAAF,OAAM,GAAG,KAAK;AAAA,UAChC;AAAA,UACA;AAAA,QACE,IAAA;AACJ,eAAO,KAAK;AAEZ,cAAM,mBAAmB,CAAC,aAAa,aAAa,EAAE,SAAS,SAAS,IACpE,CAAC,SAAS,IACV,CAAC,WAAW,SAAS;AAEzB,cAAM,oBAAoB;AAAA,UACxB;AAAA,UACA,CAAC,gBAAgB,GAAG,kBAAkB,UAAU,YAAY;AAAA,UAC5D,CAAC;AAAA,UACD,MAAM;AAGF,cAAA,oBAAoB,CAAC,GAAG,mBAAmB,EAAE,GAAG,MAAM,MAAAA,OAAM;AAElE;AAAA,UACE;AAAA,UACA,CAAC,gBAAgB,GAAG,kBAAkB,UAAU,YAAY;AAAA,UAC5D;AAAA,QAAA;AAGF,YAAI,OAAO,0BAA0B;AACnC,gBAAM,oBAAoB,KAAK;AACzB,gBAAA,iBAAiB,MAAM,WAAW,iBAAiB;AACzD,gBAAM,uBAAuB,eAAe;AAC5C,gBAAM,+BACJ,MAAM,aAAa,WAAW,iBAAiB,MAAM;AAEvD,cAAI,wBAAwB,8BAA8B;AACxD;AAAA,UACF;AAGW,qBAAA,aAAa,WAAW,iBAAiB,IAAI;AAExD,gBAAM,mBAAmB;AAAA,YACvB,eAAe,OAAO;AAAA,YACtB,MAAM;AAAA,UAAA;AAIR,gBAAM,sCAAsC,iBAAiB,OAAO,CAAC,aAAa;AAChF,mBAAO,IAAI,OAAO,CAAC,gBAAgB,cAAc,QAAQ,CAAC,MAAM;AAAA,UAAA,CACjE;AAEmC,8CAAA,QAAQ,CAAC,aAAa;AAClD,kBAAA,cAAc,IAAI,OAAO,CAAC,cAAc,QAAQ,GAAG,CAAA,CAAE;AACrD,kBAAA,cAAc,YAAY,eAAe;AAG/C,gBAAI,CAAC,aAAa;AACL,yBAAA,aAAa,WAAW,QAAQ,IAAI;AAAA,YACjD;AAAA,UAAA,CACD;AAED;AAAA,QACF;AAEM,cAAA,8BAA8B,KAAK,SAAS;AAElD,YAAI,6BAA6B;AAC/B,gBAAM,SAAS,KAAK;AACd,gBAAA,kBAAkB,KAAK,mBAAmB;AAChD,gBAAM,WAAW,KAAK;AAChB,gBAAA,eAAe,gBAAgB,UAAU,eAAe;AACxD,gBAAA,aAAa,IAAI,OAAO,CAAC,gBAAgB,GAAG,kBAAkB,KAAK,CAAC;AAKxE,cAAA,KAAK,SAAS,cACd,iBAAiB,YACjB,iBAAiB,aACjB,WAAW,YACX;AACA,kBAAM,oBAAoB;AAAA,cACxB,MAAM;AAAA,cACN,UAAU,oBAAoB,YAAY;AAAA,cAC1C;AAAA,cACA,iBAAiBA;AAAA,cACjB,MAAM;AAAA,YAAA;AAGR,gBAAI,KAAK,SAAS;AAChB,gCAAkB,UAAU,KAAK;AAAA,YACnC;AAEA,kBAAM,kBAAkB,CAAC,GAAG,mBAAmB,iBAAiB;AAEhE;AAAA,cACE;AAAA,cACA,CAAC,gBAAgB,GAAG,kBAAkB,UAAU,YAAY;AAAA,cAC5D;AAAA,YAAA;AAAA,UAEJ;AAAA,QACF;AAEA;AAAA,MACF;AAAA,MACA,KAAKG,uCAA+C;AAC5C,cAAA,EAAE,mBAAmB,gBAAoB,IAAA;AAE/C,cAAM,mBAAmB;AAAA,UACvB,MAAM,aAAa;AAAA,UACnB;AAAA,QAAA;AAGc,wBAAA,QAAQ,CAAC,iBAAiB;AACxC,qBAAW,aAAa,YAAY,OAAO,WAAW,gBAAgB,EAAE,WAAW;AAAA,YACjF;AAAA,UAAA;AAAA,QACF,CACD;AAED;AAAA,MACF;AAAA,MACA,KAAKC,4BAAoC;AACjC,cAAA;AAAA,UACJ,gBAAgB,EAAE,MAAAJ,OAAM,GAAG,KAAK;AAAA,UAChC;AAAA,UACA;AAAA,QACE,IAAA;AAEJ,cAAM,mBAAmB,CAAC,aAAa,aAAa,EAAE,SAAS,SAAS,IACpE,CAAC,SAAS,IACV,CAAC,WAAW,SAAS;AAEzB,cAAM,oBAAoB;AAAA,UACxB;AAAA,UACA,CAAC,gBAAgB,GAAG,kBAAkB,UAAU,YAAY;AAAA,UAC5D,CAAC;AAAA,UACD,MAAM;AAGF,cAAA,oBAAoB,CAAC,GAAG,mBAAmB,EAAE,GAAG,MAAM,MAAAA,OAAM;AAElE;AAAA,UACE;AAAA,UACA,CAAC,gBAAgB,GAAG,kBAAkB,UAAU,YAAY;AAAA,UAC5D;AAAA,QAAA;AAGF;AAAA,MACF;AAAA,MACA,KAAKK,gCAAwC;AACrC,cAAA,EAAE,mBAAmB,cAAkB,IAAA;AAE7C,cAAM,mBAAmB;AAAA,UACvB,MAAM,aAAa;AAAA,UACnB;AAAA,QAAA;AAGF,cAAM,sBACJ,MAAM,aAAa,YAAY,OAAO,WAAW,gBAAgB,EAAE;AAErE,cAAM,oBAAoB,WAAW,CAAC,GAAG,qBAAqB,GAAG,aAAa,CAAC;AAE/E,mBAAW,aAAa,YAAY,OAAO,WAAW,gBAAgB,EAAE,aACtE;AAGF,cAAM,mBAAmB;AAAA,UACvB,QAAQ,WAAW,aAAa,YAAY,OAAO,UAAU;AAAA,UAC7D,MAAM;AAAA,QAAA;AAIR,cAAM,sCAAsC,iBAAiB,OAAO,CAAC,aAAa;AAChF,iBAAO,IAAI,OAAO,CAAC,gBAAgB,cAAc,QAAQ,CAAC,MAAM;AAAA,QAAA,CACjE;AAEmC,4CAAA,QAAQ,CAAC,aAAa;AAClD,gBAAA,cAAc,IAAI,OAAO,CAAC,cAAc,QAAQ,GAAG,CAAA,CAAE;AACrD,gBAAA,cAAc,YAAY,eAAe;AAG/C,cAAI,CAAC,aAAa;AACL,uBAAA,aAAa,WAAW,QAAQ,IAAI;AAAA,UACjD;AAAA,QAAA,CACD;AAED;AAAA,MACF;AAAA,MACA,KAAKC,yBAAiC;AACpC,cAAM,YAAY;AAAA,UAChB,KAAK,OAAO;AAAA,UACZ,aAAa;AAAA,UACb,UAAU,OAAO;AAAA,UACjB,QAAQ;AAAA,YACN,GAAG,OAAO;AAAA,YACV,YAAY,CAAC;AAAA,UACf;AAAA,QAAA;AAGS,mBAAA,WAAW,OAAO,GAAG,IAAI;AAEpC,YAAI,OAAO,0BAA0B;AACnC,qBAAW,aAAa,WAAW,OAAO,GAAG,IAAI;AAAA,QACnD;AAEA;AAAA,MACF;AAAA,MACA,KAAKC,eAAuB;AAC1B,cAAM,YAAY;AAAA,UAChB,KAAK,OAAO;AAAA,UACZ,aAAa;AAAA,UACb,QAAQ;AAAA,YACN,GAAG,OAAO;AAAA,YACV,YAAY,CAAC;AAAA,UACf;AAAA,QAAA;AAGS,mBAAA,aAAa,OAAO,GAAG,IAAI;AAEtC;AAAA,MACF;AAAA,MACA,KAAKC,gBAAwB;AACrB,cAAA;AAAA,UACJ,gBAAgB,EAAE,MAAAR,OAAM,GAAG,KAAK;AAAA,UAChC;AAAA,UACA;AAAA,UACA;AAAA,QACE,IAAA;AAEJ,cAAM,uBAAuB,iBAAiB;AAC9C,cAAM,mBAAmB,CAAC,aAAa,aAAa,EAAE,SAAS,SAAS,IACpE,CAAC,SAAS,IACV,CAAC,WAAW,SAAS;AAEzB,cAAM,wBAAwB;AAAA,UAC5B,IAAI,OAAO,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;AAAA,UAChD;AAAA,QAAA;AAGI,cAAA,oBAAoB,KAAK,SAAS;AAExC,YAAI,CAAC,mBAAmB;AACtB;AAAA,YACE;AAAA,YACA,CAAC,gBAAgB,GAAG,kBAAkB,UAAU,cAAc,qBAAqB;AAAA,YACnF,OAAO;AAAA,UAAA;AAGT;AAAA,QACF;AAEM,cAAA,oBAAoB,IAAI,OAAO;AAAA,UACnC;AAAA,UACA,GAAG;AAAA,UACH;AAAA,UACA;AAAA,QAAA,CACD,EAAE,MAAM;AAGT,cAAM,QAAQ;AAAA,UACZ,MAAAA;AAAA,UACA,UAAU,KAAK;AAAA,UACf,QAAQ,KAAK;AAAA,UACb,iBAAiB,KAAK;AAAA,UACtB,MAAM;AAAA,QAAA;AAGR,YAAI,KAAK,SAAS;AAChB,gBAAM,UAAU,KAAK;AAAA,QACvB;AAEA,YAAI,KAAK,eAAe;AACtB,gBAAM,gBAAgB,KAAK;AAAA,QAC7B;AAEA,cAAM,wBAAwB,kBAAkB;AAAA,UAC9C,CAAC,EAAE,MAAAA,OAAK,MAAMA,WAAS,iBAAiB;AAAA,QAAA;AAI1C,YAAI,0BAA0B,IAAI;AACd,4BAAA,OAAO,uBAAuB,GAAG,KAAK;AAAA,QAC1D;AAEA,YAAI,gCAAgC;AACpC,YAAI,gCAAgC;AACpC,YAAI,4BAA4B;AAChC,YAAI,2BAA2B;AAEzB,cAAA,aAAa,IAAI,OAAO,CAAC,gBAAgB,GAAG,kBAAkB,KAAK,CAAC;AACpE,cAAA,0BAA0B,iBAAiB,WAAW,KAAK;AAC3D,cAAA,4BAA4B,KAAK,WAAW;AAClD,cAAM,eAAe,gBAAgB,KAAK,UAAU,KAAK,eAAe;AACxE,cAAM,sBAAsB;AAAA,UAC1B,iBAAiB;AAAA,UACjB,iBAAiB;AAAA,QAAA;AAEb,cAAA,sBAAsB,iBAAiB,WAAW;AACxD,cAAM,wBAAwB,wBAAwB;AACtD,cAAM,qDACJ,2BACA,CAAC,6BACD,uBACA;AACI,cAAA,2DACJ,yBACA,uBACA,CAAC,UAAU,SAAS,EAAE,SAAS,YAAY,KAC3C;AACF,cAAM,2DACJ,CAAC,mBAAmB,SAAS,mBAAmB,KAChD,CAAC,mBAAmB,SAAS,YAAY,KACzC,uBACA,6BACA;AACI,cAAA,2DACJ,mBAAmB,SAAS,mBAAmB,KAC/C,CAAC,mBAAmB,SAAS,YAAY,KACzC,uBACA,6BACA;AACF,cAAM,qDACJ,2BACA,6BACA,CAAC,mBAAmB,SAAS,YAAY;AAG3C,YACE,sDACA,0DACA;AACA,0CAAgC,iBAAiB;AAAA,QACnD;AAGA,YAAI,+BAA+B;AACjC,gBAAM,gBAAgB,kBAAkB;AAAA,YACtC,CAAC,EAAE,MAAAA,aAAWA,WAAS;AAAA,UAAA;AAGP,4BAAA,OAAO,eAAe,CAAC;AAAA,QAC3C;AAGA,YAAI,CAAC,oDAAoD;AACjD,gBAAA,2BAA2B,IAAI,OAAO;AAAA,YAC1C;AAAA,YACA,iBAAiB;AAAA,UAAA,CAClB;AAED,cAAI,0BAA0B;AAC5B,kBAAM,yBAAyB;AAAA,cAC7B;AAAA,cACA,iBAAiB;AAAA,YAAA;AAGnB,uCAA2B,IAAI,OAAO;AAAA,cACpC;AAAA,cACA,iBAAiB;AAAA,cACjB;AAAA,cACA;AAAA,cACA;AAAA,YAAA,CACD;AAAA,UACH;AAAA,QACF;AAGA,YACE,4DACA,oDACA;AAC4B,sCAAA;AAAA,YAC1B,MAAM,KAAK;AAAA,YACX,UAAU,oBAAoB,YAAY;AAAA,YAC1C,QAAQ,KAAK;AAAA,YACb,iBAAiBA;AAAA,YACjB,MAAM;AAAA,UAAA;AAGR,cAAI,KAAK,SAAS;AAChB,sCAA0B,UAAU,KAAK;AAAA,UAC3C;AAEI,cAAA,4BAA4B,yBAAyB,eAAe;AACtE,sCAA0B,gBAAgB,yBAAyB;AAAA,UACrE;AAEA,gBAAM,0BAA0B,kBAAkB;AAAA,YAChD,CAAC,EAAE,MAAAA,OAAK,MAAMA,WAAS,iBAAiB;AAAA,UAAA;AAE1C,gBAAM,0BAA0B,kBAAkB;AAAA,YAChD,CAAC,EAAE,MAAM,eAAeA,UAAS;AAAA,UAAA;AAGnC,gBAAM,iBACH,4BAA4B,KAAK,0BAA0B,2BAC5D;AAEgB,4BAAA,OAAO,eAAe,GAAG,yBAAyB;AAAA,QACtE;AAEA,YAAI,0DAA0D;AAC5D,0CAAgC,iBAAiB;AAErB,sCAAA;AAAA,YAC1B,MAAM,KAAK;AAAA,YACX,UAAU,oBAAoB,YAAY;AAAA,YAC1C,QAAQ,KAAK;AAAA,YACb,iBAAiBA;AAAA,YACjB,MAAM;AAAA,UAAA;AAGR,cAAI,KAAK,SAAS;AAChB,sCAA0B,UAAU,KAAK;AAAA,UAC3C;AAEI,cAAA,4BAA4B,yBAAyB,eAAe;AACtE,sCAA0B,gBAAgB,yBAAyB;AAAA,UACrE;AAEA,cAAI,+BAA+B;AACjC,kBAAM,gBAAgB,kBAAkB;AAAA,cACtC,CAAC,EAAE,MAAAA,aAAWA,WAAS;AAAA,YAAA;AAGP,8BAAA,OAAO,eAAe,GAAG,yBAAyB;AAAA,UACtE;AAAA,QACF;AAEA;AAAA,UACE;AAAA,UACA,CAAC,gBAAgB,GAAG,kBAAkB,UAAU,YAAY;AAAA,UAC5D;AAAA,QAAA;AAGF;AAAA,MACF;AAAA,MACA,KAAKS,6BAAqC;AACxC,cAAM,EAAE,WAAW,WAAW,kBAAkB,mBAAmB;AAEnE,cAAM,uBAAuB,iBAAiB;AAC9C,cAAM,mBAAmB,CAAC,aAAa,aAAa,EAAE,SAAS,SAAS,IACpE,CAAC,SAAS,IACV,CAAC,WAAW,SAAS;AAEzB,cAAM,wBAAwB;AAAA,UAC5B,IAAI,OAAO,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;AAAA,UAChD;AAAA,QAAA;AAGF;AAAA,UACE;AAAA,UACA,CAAC,gBAAgB,GAAG,kBAAkB,UAAU,cAAc,qBAAqB;AAAA,UACnF;AAAA,QAAA;AAGF;AAAA,MACF;AAAA,MACA,KAAKC,oBAA4B;AAC/B,mBAAW,aAAa,OAAO;AAC/B,mBAAW,oBAAoB,OAAO;AACtC,mBAAW,sBAAsB,OAAO;AACxC,mBAAW,eAAe,OAAO;AACjC,mBAAW,gBAAgB,OAAO;AAClC,mBAAW,YAAY;AAEvB;AAAA,MACF;AAAA,MACA,KAAKC,uBAA+B;AAElC,mBAAW,eAAe,MAAM;AAChC,mBAAW,aAAa,MAAM;AAE9B;AAAA,MACF;AAAA,MACA,KAAKC,eAAuB;AACnB,eAAAb;AAAAA,MACT;AAAA,MACA,KAAKc,oCAA4C;AAC/C,cAAM,mBAAmB,mBAAmB,MAAM,aAAa,aAAa,OAAO,MAAM;AAEzF,mBAAW,aAAa,YAAY,OAAO,WAAW,gBAAgB,EAAE,WAAW;AAAA,UACjF,OAAO;AAAA,UACP;AAAA,QAAA;AAGF;AAAA,MACF;AAAA,MACA,KAAKC,cAAsB;AACnB,cAAA,EAAE,aAAa,sBAA0B,IAAA;AAC/C,cAAM,mBAAmB,CAAC,gBAAgB,aAAa,UAAU,YAAY;AAC7E,cAAM,yBAAyB;AAAA,UAC7B,MAAM,aAAa,WAAW;AAAA,UAC9B;AAAA,QAAA;AAGF,cAAM,0BAA0B,CAAC,GAAG,kBAAkB,sBAAsB;AACtE,cAAA,wBAAwB,IAAI,OAAO,uBAAuB;AAC1D,cAAA,8BAA8B,sBAAsB,SAAS;AAGnE,cAAM,iDAAiD,gBAAgB;AAEvE,YAAI,+BAA+B,gDAAgD;AACjF,gBAAM,EAAE,QAAQ,UAAU,gBAAA,IAAoB;AACxC,gBAAA,eAAe,gBAAgB,UAAU,eAAe;AAExD,gBAAA,MAAM,MAAM,aAAa,YAAY;AAC3C,gBAAM,gCACJ,WAAW,OAAO,CAAC,mBAAmB,SAAS,YAAY;AAE7D,cAAI,+BAA+B;AACjC,kBAAM,aAAa,MAAM,aAAa,WAAW,EAAE,OAAO,WAAW;AACrE,kBAAM,iBAAiB,WAAW,OAAO,CAAC,cAAc;AAClD,kBAAA,UAAU,SAAS,uBAAuB;AACrC,uBAAA;AAAA,cACT;AAEA,kBAAI,UAAU,WAAW,OAAO,UAAU,oBAAoB,uBAAuB;AAC5E,uBAAA;AAAA,cACT;AAEO,qBAAA;AAAA,YAAA,CACR;AAED,uBAAW,aAAa,WAAW,EAAE,OAAO,aAAa;AAEzD;AAAA,UACF;AAAA,QACF;AAGA,cAAM,oBAAoB,MAAM,aAAa,WAAW,EAAE,OAAO,WAC9D,MAAA,EACA,OAAO,CAAC,KAAKhB,aAAY;AACpBA,cAAAA,SAAQ,SAAS,OAAO;AACnB,mBAAA;AAAA,UACT;AAEIA,cAAAA,SAAQ,gBAAgB,uBAAuB;AAC1C,mBAAA;AAAA,UACT;AAEI,cAAA,KAAKA,SAAQ,IAAI;AAEd,iBAAA;AAAA,QACT,GAAG,CAAE,CAAA;AAEW,0BAAA,QAAQ,CAAC,cAAc;AACvC,gBAAM,aAAa,mBAAmB,MAAM,aAAa,WAAW,GAAG,SAAS;AAEhF,iBAAO,WAAW,aAAa,WAAW,EAAE,OAAO,WAAW,UAAU,EAAE;AAAA,QAAA,CAC3E;AAED,mBAAW,aAAa,WAAW,EAAE,OAAO,WAAW,OAAO,wBAAwB,CAAC;AAEvF;AAAA,MACF;AAAA,MACA,KAAKiB,uCAA+C;AAC5C,cAAA,EAAE,uBAAuB,aAAiB,IAAA;AAEhD,cAAM,yBAAyB;AAAA,UAC7B,MAAM,aAAa,WAAW,YAAY;AAAA,UAC1C;AAAA,QAAA;AAGF,mBAAW,aAAa,WAAW,YAAY,EAAE,OAAO,WAAW;AAAA,UACjE;AAAA,UACA;AAAA,QAAA;AAGF;AAAA,MACF;AAAA,MACA,KAAKC,mBAA2B;AAC9B,mBAAW,0BAA0B;AACrC,mBAAW,cAAc,OAAO;AAChC,mBAAW,eAAe,OAAO;AAI7B,YAAA,CAAC,OAAO,sBAAsB;AAChC,qBAAW,aAAa,MAAM;AAC9B,qBAAW,eAAe,MAAM;AAAA,QAClC;AAEA;AAAA,MACF;AAAA,MACA,KAAKC,eAAuB;AACpB,cAAA;AAAA,UACJ,MAAM,EAAE,aAAa,UAAU,MAAM,KAAK;AAAA,UAC1C;AAAA,UACA;AAAA,QACE,IAAA;AAEJ,mBAAW,aAAa,UAAU,EAAE,OAAO,cAAc;AAErD,YAAA,OAAO,eAAe,aAAa;AAC1B,qBAAA,aAAa,UAAU,WAAW;AAClC,qBAAA,aAAa,UAAU,OAAO,OAAO;AAChD,gBAAM,iBAAiB,QAAQ,WAAW,aAAa,SAAS;AACrD,qBAAA,WAAW,GAAG,IAAI;AAE7B;AAAA,QACF;AAEW,mBAAA,aAAa,YAAY,OAAO,OAAO;AAElD;AAAA,MACF;AAAA,MACA;AACS,eAAA;AAAA,IACX;AAAA,EAAA,CACD;AAAA;AC9oBG,MAAA,aAAa,CAACjB,UAAS,QAAQA,OAAM,EAAE,WAAW,IAAK,CAAA;ACFtD,MAAM,YAAY;AAClB,MAAM,4BAA4B;AAClC,MAAM,0BAA0B;AAChC,MAAM,cAAc;AACpB,MAAM,wDACX;AACK,MAAM,oCACX;AACK,MAAM,0DACX;AACK,MAAM,mBAAmB;AACzB,MAAM,4BAA4B;AAClC,MAAM,+BACX;AACK,MAAM,+BACX;AACK,MAAM,aAAa;ACdpB,MAAA,YAAY,CAACA,UAAS;AACpB,QAAA,YAAY,WAAWA,KAAI;AACjC,QAAM,MAAM,QAAQ,SAAS,IAAI,SAAS;AAEnC,SAAA;AACT;AAGM,MAAA,qBAAqB,CAACA,OAAM,aAAa;AAC7C,SAAO,GAAG,WAAW,QAAQ,CAAC,IAAI,WAAWA,KAAI,CAAC;AACpD;ACZA,MAAM,mCAAmC,CAAC,KAAK,WAAW;AACxD,MAAI,OAAO,OAAO;AAChB,WAAO,OAAO,MAAM,OAAO,kCAAkC,GAAG;AAAA,EAClE;AAEA,MAAI,kBAAkB,QAAQ;AACtB,UAAA,EAAE,MAAAA,OAAM,aAAiB,IAAA;AAC/B,QAAI,KAAK,EAAE,MAAAA,OAAM,aAAc,CAAA;AAAA,EACjC;AAEO,SAAA;AACT;ACTA,MAAM,sBAAsB,CAAC,WAC3B,CAAC,cAAc,aAAa,SAAS,EAAE,SAAS,MAAM,IAAI,IAAI;AAEhE,MAAM,iCAAiC,CAAC,WACtC,CAAC,cAAc,WAAW,EAAE,SAAS,MAAM,IAAI,IAAI;ACOrD,MAAM,eAAe;AAAA,EACnB,YAAY,CAAC;AAAA,EACb,cAAc,CAAC;AAAA,EACf,aAAa,CAAC;AAAA,EACd,mBAAmB,CAAC;AAAA,EACpB,sCAAsC;AACxC;AAEA,MAAM,UAAU,CAAC,QAAQ,cAAc;AAAA;AAAA,EAErC,QAAQ,OAAO,CAAC,eAAe;AAC7B,YAAQ,OAAO,MAAM;AAAA,MACnB,KAAKkB,WAAmB;AAChB,cAAA,EAAE,MAAM,MAAU,IAAA;AACxB,cAAM,MAAM,MAAM;AACZ,cAAA,kBAAkB,QAAQ,IAAI,OAAO;AAG3C,YAAI,mBAAmB,KAAK,WAAW,KAAK,KAAK,SAAS,MAAM,GAAG;AACjE,gBAAM,eAAe,IAAI;AAErB,cAAA,gBAAgB,CAAC,QAAQ,YAAY,MAAM,EAAE,SAAS,YAAY,GAAG;AAEvE,mBAAO,WAAW,aAAa;AAAA,UACjC;AAAA,QACF;AAEA,YAAI,YAAY,CAAC,gBAAgB,GAAG,IAAI,GAAG,KAAK;AAEhD;AAAA,MACF;AAAA,MACA,KAAKC,2BAAmC;AAChC,cAAA;AAAA,UACJ,QAAQ;AAAA,YACN;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,UACF;AAAA,QACE,IAAA;AAEJ,YAAI,mDAAmD;AACvD,YAAI,sBAAsB;AAE1B,YAAI,YAAY,CAAC,gBAAgB,QAAQ,GAAG,KAAK;AAEjD,cAAM,eAAe,MAAM;AAIvB,YAAA,MAAM,QAAQ,iCAAiC,GAAG;AACpD,gBAAM,sBAAsB;AAAA,YAC1B,aAAa;AAAA,YACb,aAAa;AAAA,UAAA;AAGf,cAAI,CAAC,kCAAkC,SAAS,mBAAmB,GAAG;AAC9D,kBAAA,gBAAgB,kCAAkC,CAAC;AACN,+DAAA;AAC7B,kCAAA;AAEtB,gBAAI,kBAAkB,UAAU;AAC9B,kBAAI,YAAY,CAAC,gBAAgB,UAAU,GAAG,UAAU;AAAA,YAAA,WAC/C,kBAAkB,WAAW;AACtC,kBAAI,YAAY,CAAC,gBAAgB,UAAU,GAAG,WAAW;AAAA,YAAA,OACpD;AACL,kBAAI,YAAY,CAAC,gBAAgB,UAAU,GAAG,aAAa;AAAA,YAC7D;AAAA,UACF;AAAA,QACF;AAEI,YAAA;AAEJ,YAAI,kDAAkD;AACxC,sBAAA;AAAA,YACV,UAAU,WAAW,+BAA+B,CAAC;AAAA,YACrD,oBAAoB,mBAAmB;AAAA,UAAA;AAAA,QACzC,OACK;AACO,sBAAA;AAAA,YACV,UAAU,WAAW,+BAA+B,CAAC;AAAA,YAErD,oBAAoB,aAAa,QAAQ;AAAA,UAAA;AAAA,QAE7C;AAEA,YAAI,YAAY,CAAC,gBAAgB,MAAM,GAAG,SAAS;AAE7C,cAAA,yBAAyB,MAAM,aAAa;AAElD,YAAI,2BAA2B,MAAM;AACnC;AAAA,QACF;AAIA,YACE,oDACA,CAAC,UAAU,SAAS,EAAE,SAAS,mBAAmB,GAClD;AACA,cAAI,YAAY,CAAC,gBAAgB,iBAAiB,GAAG,IAAI;AAEzD;AAAA,QACF;AAEA,cAAM,uBAAuB;AAAA,UAC3B,UAAU,WAAW,qCAAqC,CAAC;AAAA,UAC3D,+BAA+B,aAAa,QAAQ;AAAA,QAAA;AAGtD,YAAI,YAAY,CAAC,gBAAgB,iBAAiB,GAAG,oBAAoB;AAEzE;AAAA,MACF;AAAA,MACA,KAAKC,yBAAiC;AAC9B,cAAA;AAAA,UACJ,QAAQ,EAAE,uCAAuC,MAAM;AAAA,QACrD,IAAA;AAEE,cAAA,cAAc,MAAM,aAAa;AAGvC,YAAI,CAAC,CAAC,UAAU,SAAS,EAAE,SAAS,KAAK,GAAG;AAC1C,cAAI,YAAY,CAAC,gBAAgB,UAAU,GAAG,KAAK;AAC7C,gBAAA,yBAAyB,MAAM,aAAa;AAElD;AAAA,YACE;AAAA,YACA,CAAC,gBAAgB,MAAM;AAAA,YACvB,UAAU,UAAU,WAAW,WAAW,CAAC,GAAG,oBAAoB,KAAK,CAAC;AAAA,UAAA;AAG1E;AAAA,YACE;AAAA,YACA,CAAC,gBAAgB,iBAAiB;AAAA,YAClC;AAAA,cACE,0BACE,UAAU,WAAW,qCAAqC,CAAC;AAAA,cAC7D,+BAA+B,KAAK;AAAA,YACtC;AAAA,UAAA;AAGF;AAAA,QACF;AAEA,YAAI,UAAU,UAAU;AACtB,cAAI,YAAY,CAAC,gBAAgB,UAAU,GAAG,UAAU;AACxD,cAAI,YAAY,CAAC,gBAAgB,iBAAiB,GAAG,IAAI;AACrD,cAAA,YAAY,CAAC,gBAAgB,MAAM,GAAG,UAAU,UAAU,WAAW,GAAG,CAAC,CAAC;AAE9E;AAAA,QACF;AAGA,YAAI,YAAY,CAAC,gBAAgB,UAAU,GAAG,WAAW;AACzD,YAAI,YAAY,CAAC,gBAAgB,iBAAiB,GAAG,IAAI;AACrD,YAAA,YAAY,CAAC,gBAAgB,MAAM,GAAG,UAAU,UAAU,WAAW,GAAG,CAAC,CAAC;AAE9E;AAAA,MACF;AAAA,MAEA,KAAKC;AACI,eAAA;AAAA,MACT,KAAKC,uDAA+D;AAGlE,cAAM,YAAY;AAAA,UAChB,GAAG;AAAA,UACH,cAAc;AAAA,YACZ,MAAM;AAAA,YACN,YAAY;AAAA,YACZ,GAAG,OAAO;AAAA,UACZ;AAAA,QAAA;AAGK,eAAA;AAAA,MACT;AAAA,MACA,KAAKC,mCAA2C;AAExC,cAAA,oBAAoB,MAAM,aAAa;AAC7C,cAAM,eAAe;AAAA,UACnB,aAAa,kBAAkB;AAAA,UAC/B,MAAM;AAAA,UACN,YAAY;AAAA,UACZ,GAAG,OAAO;AAAA,UACV,WAAW,mBAAmB,kBAAkB,aAAa,kBAAkB,QAAQ;AAAA,QAAA;AAGzF,cAAM,YAAY;AAAA,UAChB,GAAG;AAAA,UACH;AAAA,UACA;AAAA,UACA,sCAAsC,MAAM,aAAa;AAAA,QAAA;AAGpD,eAAA;AAAA,MACT;AAAA,MACA,KAAKC,yDAAiE;AACpE,cAAM,YAAY,MAAM;AACxB,cAAM,YAAY;AAAA,UAChB,GAAG;AAAA,UACH,iBAAiB;AAAA,UACjB,mBAAmB,EAAE,MAAM,YAAY;AAAA,QAAA;AAGzC,eAAO,EAAE,GAAG,cAAc,cAAc,UAAU;AAAA,MACpD;AAAA,MACA,KAAKC,kBAA0B;AAC7B,mBAAW,eAAe,OAAO;AACjC,mBAAW,cAAc,OAAO;AAChC;AAAA,MACF;AAAA,MACA,KAAKC,2BAAmC;AAChC,cAAA;AAAA,UACJ;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA,UAAU,CAAC;AAAA,QACT,IAAA;AAEJ,YAAI,WAAW;AACb,qBAAW,eAAe;AAC1B,qBAAW,cAAc;AAEzB;AAAA,QACF;AAEI,YAAA;AAEJ,YAAI,kBAAkB,aAAa;AACjC,cAAI,SAAS,KAAK;AACJ,wBAAA;AAAA,cACV,MAAM;AAAA,cACN,iBAAiB;AAAA,cACjB,mBAAmB,EAAE,MAAM,YAAY;AAAA,YAAA;AAAA,UACzC,OACK;AACO,wBAAA;AAAA,cACV,GAAG;AAAA,cACH,MAAM;AAAA,cACN,YAAY;AAAA,YAAA;AAAA,UAEhB;AAAA,QAAA,WACS,kBAAkB,eAAe;AAC9B,sBAAA;AAAA,YACV,GAAG;AAAA,YACH,MAAM;AAAA,YACN,YAAY,CAAC;AAAA,UAAA;AAAA,QACf,WACS,kBAAkB,QAAQ;AACnC,sBAAY,EAAE,GAAG,SAAS,MAAM,SAAS;AAAA,QAChC,WAAA,kBAAkB,YAAY,kBAAkB,QAAQ;AACrD,sBAAA;AAAA,QAAA,WACH,kBAAkB,SAAS;AACxB,sBAAA;AAAA,YACV,cAAc,CAAC,UAAU,SAAS,UAAU,QAAQ;AAAA,YACpD,MAAM;AAAA,YACN,UAAU;AAAA,YACV,GAAG;AAAA,UAAA;AAAA,QACL,WACS,kBAAkB,eAAe;AAC1C,sBAAY,EAAE,GAAG,SAAS,MAAM,eAAe,MAAM,CAAA;QAAG,WAC/C,kBAAkB,YAAY;AAC3B,sBAAA;AAAA,YACV,MAAM,UAAU,oBAAoB;AAAA,YACpC,UAAU;AAAA,YACV,iBAAiB;AAAA,YACjB,QAAQ;AAAA,YACR,MAAM;AAAA,UAAA;AAAA,QACR,OACK;AACL,sBAAY,EAAE,GAAG,SAAS,MAAM,eAAe,SAAS;QAC1D;AAEA,mBAAW,eAAe;AAE1B;AAAA,MACF;AAAA,MACA,KAAKC,8BAAsC;AACzC,cAAM,EAAE,aAAa,WAAW,6BAA6B,UAAU,CAAA,EAAO,IAAA;AAE9E,YAAI,WAAW;AACb,qBAAW,eAAe;AAC1B,qBAAW,cAAc;AAEzB;AAAA,QACF;AAEA,mBAAW,eAAe,EAAE,GAAG,SAAS,MAAM,YAAY;AAE1D,cAAM,aAAa;AAAA,UACjB,GAAI,aAAa,SAAS,QAAQ,CAAC;AAAA,UACnC,GAAI,aAAa,SAAS,YAAY,CAAC;AAAA,QAAA;AAGzC,cAAM,iBAAiB,WAAW,OAAO,kCAAkC,CAAE,CAAA;AAE7E,YAAI,eAAe,QAAQ;AACV,yBAAA;AAAA,YAAQ,CAAC,EAAE,MAAA3B,OAAM,mBAC9B,IAAI,WAAW,cAAcA,OAAM,YAAY;AAAA,UAAA;AAAA,QAEnD;AAEA;AAAA,MACF;AAAA,MACA,KAAK4B,8BAAsC;AACzC,mBAAW,eAAe,OAAO;AACjC,mBAAW,cAAc,OAAO;AAChC;AAAA,MACF;AAAA,MACA,KAAKC,YAAoB;AACvB,mBAAW,aAAa,OAAO;AAC/B;AAAA,MACF;AAAA,MACA;AACS,eAAA;AAAA,IACX;AAAA,EAAA,CACD;AAAA;ACzUH,MAAM,WAAW;AAAA,EACf,CAAC,GAAG,QAAQ,YAAY,GAAGC;AAAAA,EAC3B,CAAC,GAAG,QAAQ,sBAAsB,GAAGC;AACvC;ACHA,MAAM,WAAW;AAAA,EACf,YAAY;AAAA,IACV,QAAQ,CAAC;AAAA,IACT,IAAI,EAAE,IAAI,aAAa;AACrB,UAAI,CAAC,KAAK,OAAO,EAAE,GAAG;AACf,aAAA,OAAO,EAAE,IAAI;AAAA,MACpB;AAAA,IACF;AAAA,EACF;AAAA,EACA,OAAO;AAAA,IACL,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAYX;AAAA,IACA,aAAa;AAAA,MACX,YAAY,CAAC;AAAA,MACb,MAAM;AAAA,QACJ,UAAU,CAAC;AAAA,QACX,MAAM,CAAC;AAAA,MACT;AAAA,IACF;AAAA,IACA,WAAW;AAAA,MACT,YAAY,CAAC;AAAA,MACb,MAAM;AAAA,QACJ,UAAU,CAAC;AAAA,QACX,MAAM,CAAC;AAAA,MACT;AAAA,IACF;AAAA,EACF;AAAA,EACA,4BAA4B,CAAC;AAAA,EAC7B,6BAA6B,IAAI;AAC1B,SAAA,2BAA2B,KAAK,EAAE;AAAA,EACzC;AAAA,EACA,kBAAkB,EAAE,WAAW,MAAM,EAAE,UAAU,KAAA,KAAU;AACnD,UAAA,EAAE,YAAY,IAAI,KAAK;AAEjB,gBAAA,WAAW,KAAK,SAAS;AACzB,gBAAA,KAAK,SAAS,KAAK,QAAQ;AAC3B,gBAAA,KAAK,KAAK,KAAK,IAAI;AAAA,EACjC;AAAA,EACA,aAAa,QAAQ,EAAE,WAAW,MAAM,EAAE,UAAU,KAAK,KAAK;AACtD,UAAA,WAAW,KAAK,MAAM;AAErB,WAAA,QAAQ,CAAC,UAAU;AACpB,UAAA,CAAC,SAAS,KAAK,GAAG;AACpB,iBAAS,KAAK,IAAI;AAAA,UAChB,YAAY,CAAC;AAAA,UACb,MAAM;AAAA,YACJ,UAAU;AAAA;AAAA,YAEV;AAAA,YACA,MAAM;AAAA;AAAA,YAEN;AAAA,UACF;AAAA,QAAA;AAAA,MAEJ;AAEA,eAAS,KAAK,EAAE,WAAW,KAAK,SAAS;AACzC,eAAS,KAAK,EAAE,KAAK,SAAS,KAAK,QAAQ;AAC3C,eAAS,KAAK,EAAE,KAAK,KAAK,KAAK,IAAI;AAAA,IAAA,CACpC;AAAA,EACH;AAAA,EAEA,gBAAgB,QAAQ,QAAQ,MAAM;AACpC,UAAM,gBAAgB,IAAI,KAAK,OAAO,CAAC,GAAG,QAAQ,QAAQ,UAAU,GAAG,CAAA,CAAE,EAAE;AAAA,MACzE,CAAC,KAAKjC,aAAY;AACV,cAAA,WAAWA,SAAQ,KAAK;AAE9B,eAAO,CAAC,GAAG,KAAK,GAAG,QAAQ;AAAA,MAC7B;AAAA,MACA,CAAC;AAAA,IAAA;AAGI,WAAA;AAAA,EACT;AAAA,EAEA,yBAAyB,gBAAgB,cAAc,eAAe;AAEpE,QAAI,CAAC;AAAkB,aAAA;AAGvB,WAAO,eAAe,MAAM,EAAE,SAAS,IAAI,SAAS,MAAM,UAAU,aAAa,CAAC,EAAG,CAAA;AAAA,EACvF;AAAA,EAEA,cAAc,QAAQ,cAAc,MAAM;AAClC,UAAA,aAAa,IAAI,KAAK,OAAO,CAAC,GAAG,QAAQ,YAAY,GAAG,CAAA,CAAE;AAEhE,UAAM,qBAAqB,WAAW,OAAO,CAAC,KAAKA,aAAY;AACvD,YAAA,oBAAoBA,SAAQ,IAAI;AAEtC,aAAO,EAAE,GAAG,KAAK,GAAG;IACtB,GAAG,CAAE,CAAA;AAEE,WAAA,UAAU,MAAM,EAAE,eAAe,IAAI,SAAS,MAAM,kBAAkB,EAAA,CAAG;AAAA,EAClF;AAAA,EACA,wBAAwB,MAAM,aAAa;AACrC,QAAA,eAAe,UAAU,IAAI;AAE3B,UAAA,UAAU,UAAU,WAAW;AAEhC,SAAA,2BAA2B,QAAQ,CAAC,OAAO;AAC/B,qBAAA,GAAG,cAAc,OAAO;AAAA,IAAA,CACxC;AAEM,WAAA;AAAA,EACT;AACF;AC9GA,MAAM,OAAO,UAAU,OAAO;AAE9B,MAAe,QAAA;AAAA,EACb,SAAS,KAAK;AACZ,QAAI,YAAY,QAAQ;AAExB,QAAI,YAAY;AAAA,MACd,IAAI,YAAY,QAAQ;AAAA,MACxB,MAAM;AAAA,MACN,WAAW;AAAA,QACT,IAAI,GAAG,QAAQ;AAAA,QACf,gBAAgB;AAAA,MAClB;AAAA,MACA,aAAa,YAAY;AAAA,MACzB,MAAM,YAAY;AACV,cAAA,YAAY,MAAM,OAAO,sBAAa;AAErC,eAAA;AAAA,MACT;AAAA,IAAA,CACD;AAED,QAAI,eAAe;AAAA,MACjB,IAAI;AAAA,MACJ;AAAA;AAAA,MAEA,MAAM;AAAA,QACJ,OAAO;AAAA,MACT;AAAA,IAAA,CACD;AAAA,EACH;AAAA,EACA,YAAY;AAAA,EAAC;AAAA,EACb,MAAM,cAAc,EAAE,WAAW;AACzB,UAAA,gBAAgB,MAAM,QAAQ;AAAA,MAClC,QAAQ,IAAI,CAAC,WAAW;AACf,eAAA,qCAA+B,uBAAA,OAAA,EAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,6BAAA,MAAA,OAAA,sBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,GAAA,+BAAA,MAAA,OAAA,wBAAA,GAAA,0BAAA,MAAA,OAAA,mBAAA,EAAA,CAAA,GAAA,kBAAA,MAAA,OAAA,EACnC,KAAK,CAAC,EAAE,SAAS,KAAA,MAAW;AACpB,iBAAA;AAAA,YACL,MAAM,yBAAyB,MAAM,QAAQ;AAAA,YAC7C;AAAA,UAAA;AAAA,QACF,CACD,EACA,MAAM,MAAM;AACJ,iBAAA;AAAA,YACL,MAAM,CAAC;AAAA,YACP;AAAA,UAAA;AAAA,QACF,CACD;AAAA,MAAA,CACJ;AAAA,IAAA;AAGI,WAAA,QAAQ,QAAQ,aAAa;AAAA,EACtC;AACF;"}